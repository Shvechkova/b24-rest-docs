# Реакция на клик

`ActionDto` - действие определяет реакцию на клик по определенному элементу записи таймлайна. Существует несколько различных видов действий, каждое из которых имеет свой формат.

## Переход по ссылке

Если будет использована относительная ссылка на стандартные сущности портала, поддерживающие открытие в слайдере, будет показан слайдер. В противном случае будет обычный переход по ссылке.

### Параметры

{% include [Сноска о параметрах](../../../../../../_includes/required.md) %}

#|
|| **Поле** | **Описание** ||
|| **type^*^**
[`const`](../../../../data-types.md) | Должно иметь значение `redirect` ||
|| **uri**
[`string`](../../../../data-types.md) | Валидный URI ссылки, например `https://ya.ru` или `/crm/deal/details/1/` ||
|#

### Пример

```json
{
    "type": "redirect",
    "uri": "/crm/deal/details/1/"
}
```

## Rest событие

Вызов действия приведет к генерации Rest события **onCrmTimelineItemAction**. При возникновении события будут вызваны обработчики только приложения, создавшего эту запись таймлайна. В обработчик всегда будет передан контекст:

- **id** - идентификатор события,
- **entityTypeId** - идентификатор типа сущности, к которой привязано дело,
- **entityId** - идентификатор элемента этой сущности,
- **activityId** - идентификатор дела,
- **userId** - идентификатор пользователя, вызвавшего действие.

### Параметры

{% include [Сноска о параметрах](../../../../../../_includes/required.md) %}

#|
|| **Поле** | **Описание** ||
|| **type^*^**
[`const`](../../../../data-types.md) | Должно иметь значение `restEvent`. ||
|| **id^*^**
[`string`](../../../../data-types.md) | Идентификатор события. Можно указать любое удобное вам значение, например `resetButtonClick` ||
|| **actionParams**
[`array`](../../../../data-types.md) | Массив произвольного формата, данные из которого будут переданы в обработчик события ||
|| **animationType**
[`string`](../../../../data-types.md) | Анимация, которая будет показана в момент обработки события, например `disable` ||
|#

В некоторых сценариях отправка Rest события подразумевает, что обработчик этого события в итоге должен изменить внешний вид записи таймлайна. Например, добавить туда новые блоки, изменить набор кнопок и т.д.

Чтобы дать пользователю понимание, что сейчас происходит какая-то обработка, можно использовать параметр `animationType`. Если `animationType` имеет значение **loader**, то запись таймлайна будет заблокирована и поверх нее будет показан лоадер до тех пор, пока эта запись не будет обновлена через [crm.activity.configurable.update](../crm-activity-configurable-update.md). Если действие вызвано на кнопке в нижней части таймлайна и `animationType` имеет значение `disable`, то соответствующая кнопка будет заблокирована до тех пор, пока эта запись не будет обновлена через [crm.activity.configurable.update](../crm-activity-configurable-update.md).

### Пример

```json
{
    "type": "restEvent",
    "id": "resetButtonClick",
    "actionParams": {
        "myId": 123,
        "someImportant": "qwerty"
    },
    "animationType": "disable"
}
```

Если действие подобной конфигурации назначить на кнопку, то нажатие на нее приведет к вызову обработчика Rest события `onCrmTimelineItemAction`, зарегистрированного приложением, которое создало запись таймлайна. В обработчик будут переданы параметры `id=resetButtonClick`, `entityTypeId`, `entityId`, `activityId`, `userId`, а также явно определенные разработчиком параметры `myId=123` и `someImportant=qwerty`. C момента нажатия на кнопку и до тех пор, пока запись таймлайна не будет обновлена через `crm.activity.configurable.update`, кнопка будет заблокирована.

## Открытие слайдера приложения

{% note warning %}

Действие не поддерживается в мобильном приложении.

{% endnote %}

Вызов действия приведет к открытию слайдера приложения, создавшего данную запись таймлайна. В слайдер будет передан контекст:

- **entityTypeId** - идентификатор типа сущности, к которой привязано дело,
- **entityId** - идентификатор элемента этой сущности,
- **activityId** - идентификатор дела.

### Параметры

{% include [Сноска о параметрах](../../../../../../_includes/required.md) %}

#|
|| **Поле** | **Описание** ||
|| **type^*^**
[`const`](../../../../data-types.md) | Должно иметь значение `openRestApp`. ||
|| **actionParams**
[`array`](../../../../data-types.md) | Массив произвольного формата, данные из которого будут переданы в обработчик события ||
|| **sliderParams**
[ActionSliderParamsDto](#actionsliderparamsdto) | Опции, с которыми открывается слайдер ||
|#

### Пример

```json
{
    "type": "openRestApp",
    "actionParams": {
        "myId": 123,
        "someImportant": "qwerty"
    },
    "sliderParams": {
        "labelText": "это приложение",
        "labelColor": "#c3b3ff",
        "labelBgColor": "violet",
        "title": "Это заголовок слайдера приложения",
        "width": 700
    }
}
```

### ActionSliderParamsDto

#### Параметры открытия слайдера приложения

#|
|| **Поле** | **Описание** | **Дополнительно** ||
|| **width**
[`int`](../../../../data-types.md) | Ширина слайдера, `px` | Не может быть использовано одновременно с `leftBoundary` ||
|| **leftBoundary**
[`int`](../../../../data-types.md) | Слайдер во всю ширину окна браузера с отступом слева, `px` | Не может быть использовано одновременно с `width` ||
|| **labelBgColor**
[`string`](../../../../data-types.md) | Код цвета фона кнопки закрытия слайдера | Может принимать только значения `aqua|green|orange|brown|pink|blue|grey|violet` ||
|| **labelColor**
[`string`](../../../../data-types.md) | Код цвета кнопки закрытия слайдера | В `hex` формате ||
|| **labelText**
[`string`](../../../../data-types.md) | Текст кнопки закрытия слайдера | ||
|| **title**
[`string`](../../../../data-types.md) | Текст заголовка окна браузера при открытии слайдера | ||
|#

## Продолжите изучение

- [{#T}](./layout.md)
- [{#T}](./icon.md)
- [{#T}](./header.md)
- [{#T}](./body.md)
- [{#T}](./content-block.md)
- [{#T}](./footer.md)
- [{#T}](./menu-item.md)
- [{#T}](./field-types.md)
- [{#T}](./rest-app-layout-dto.md)
- [{#T}](./examples.md)